<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnEx - Windows Version</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/modern-interface.css">
    <link rel="stylesheet" href="css/enterprise-styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/loading.css">
    <link rel="stylesheet" href="css/chatbot.css">
    <link rel="stylesheet" href="css/enhanced-v2.css">
    <link rel="stylesheet" href="css/messaging-v2.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-card">
                <div class="logo">
                    <i class="fas fa-graduation-cap"></i>
                    <h1>LearnEx</h1>
                    <p>Windows Version - Sin Base de Datos</p>
                </div>
                
                <form id="loginForm">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="username" placeholder="Usuario" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" placeholder="Contrase√±a" required>
                    </div>
                    <button type="submit" class="btn-primary">Login</button>
                </form>
                
                <div class="demo-users">
                    <div style="margin-top: 15px; font-size: 12px; color: #666; text-align: center;">
                        <p><strong>Credenciales v√°lidas:</strong></p>
                        <p>carlos.gomez@mail.com / pass123</p>
                        <p>luis.perez@mail.com / luis789</p>
                        <p>ana.rodriguez@mail.com / ana456</p>
                        <p>roberto.rodriguez@mail.com / rob888</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="dashboardScreen" class="screen">
        <nav class="navbar">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>LearnEx Windows</span>
            </div>
            <div class="nav-user">
                <span id="userRole"></span>
                <button id="logoutBtn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </nav>

        <div class="main-container">
            <aside class="sidebar">
                <ul class="nav-menu" id="navMenu"></ul>
            </aside>
            <main class="content">
                <div id="contentArea"></div>
            </main>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // Global state
        const AppState = {
            currentUser: null,
            isAuthenticated: false
        };

        // Users database
        const USERS = {
            'carlos.gomez@mail.com': { id: 1, name: 'Carlos Gomez', role: 'admin', password: 'pass123' },
            'luis.perez@mail.com': { id: 3, name: 'Luis Perez', role: 'teacher', password: 'luis789' },
            'ana.rodriguez@mail.com': { id: 2, name: 'Ana Rodriguez', role: 'student', password: 'ana456' },
            'roberto.rodriguez@mail.com': { id: 102, name: 'Roberto Rodriguez', role: 'parent', password: 'rob888' },
            'pedro.sanchez@mail.com': { id: 7, name: 'Pedro Sanchez', role: 'teacher', password: 'ped987' },
            'patricia.jimenez@mail.com': { id: 103, name: 'Patricia Jimenez', role: 'parent', password: 'pat999' }
        };

        // Login function
        function login(username, password) {
            const user = USERS[username];
            if (user && user.password === password) {
                AppState.currentUser = user;
                AppState.isAuthenticated = true;
                showDashboard();
                return true;
            }
            alert('Credenciales incorrectas');
            return false;
        }

        // Show dashboard
        function showDashboard() {
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('dashboardScreen').classList.add('active');
            document.getElementById('userRole').textContent = AppState.currentUser.name;
            generateMenu();
            showView('dashboard');
        }

        // Generate menu based on role
        function generateMenu() {
            const menu = document.getElementById('navMenu');
            const menuItems = {
                admin: [
                    { id: 'dashboard', icon: 'tachometer-alt', text: 'Dashboard' },
                    { id: 'users', icon: 'users', text: 'Usuarios' },
                    { id: 'messaging', icon: 'comments', text: 'Mensajes' },
                    { id: 'analytics', icon: 'chart-bar', text: 'Analytics' }
                ],
                teacher: [
                    { id: 'dashboard', icon: 'tachometer-alt', text: 'Dashboard' },
                    { id: 'tasks', icon: 'tasks', text: 'Tareas' },
                    { id: 'messaging', icon: 'comments', text: 'Mensajes' },
                    { id: 'grades', icon: 'graduation-cap', text: 'Calificaciones' }
                ],
                student: [
                    { id: 'dashboard', icon: 'tachometer-alt', text: 'Dashboard' },
                    { id: 'tasks', icon: 'book', text: 'Mis Tareas' },
                    { id: 'messaging', icon: 'comments', text: 'Mensajes' },
                    { id: 'grades', icon: 'star', text: 'Mis Notas' }
                ],
                parent: [
                    { id: 'dashboard', icon: 'tachometer-alt', text: 'Dashboard' },
                    { id: 'messaging', icon: 'comments', text: 'Mensajes' },
                    { id: 'grades', icon: 'chart-line', text: 'Rendimiento' }
                ]
            };

            const items = menuItems[AppState.currentUser.role] || [];
            menu.innerHTML = items.map(item => `
                <li><a href="#" onclick="showView('${item.id}')">
                    <i class="fas fa-${item.icon}"></i> ${item.text}
                </a></li>
            `).join('');
        }

        // Show view
        function showView(viewName) {
            const contentArea = document.getElementById('contentArea');
            
            switch(viewName) {
                case 'dashboard':
                    contentArea.innerHTML = `
                        <h1>üè† Dashboard</h1>
                        <div class="stats-grid">
                            <div class="stat-card blue">
                                <h3>Bienvenido ${AppState.currentUser.name}</h3>
                                <p>Rol: ${AppState.currentUser.role}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'messaging':
                    contentArea.innerHTML = `
                        <div class="messaging-container enhanced">
                            <div class="conversations-sidebar">
                                <div class="sidebar-header">
                                    <h2>üí¨ Mensajes Windows</h2>
                                    <button class="btn-primary btn-sm" onclick="showNewChatModal()">
                                        <i class="fas fa-plus"></i> Nuevo
                                    </button>
                                </div>
                                <div class="conversations-list">
                                    <div class="conversation-section">
                                        <h4>üë®üè´üë®üë©üëßüë¶ Chats Disponibles</h4>
                                        <div class="conversation-item" onclick="openChat(1)">
                                            <div class="conversation-avatar teacher-parent">
                                                <i class="fas fa-chalkboard-teacher"></i>
                                            </div>
                                            <div class="conversation-info">
                                                <h4>Prof. Luis ‚Üî Roberto (Padre)</h4>
                                                <p class="last-message">Hola, ¬øc√≥mo va el rendimiento?</p>
                                            </div>
                                        </div>
                                        <div class="conversation-item" onclick="openChat(2)">
                                            <div class="conversation-avatar teacher-parent">
                                                <i class="fas fa-user-friends"></i>
                                            </div>
                                            <div class="conversation-info">
                                                <h4>Grupo Padres-Profesores</h4>
                                                <p class="last-message">Reuni√≥n programada para ma√±ana</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="chat-area">
                                <div class="chat-header">
                                    <h3>Selecciona una conversaci√≥n</h3>
                                </div>
                                <div class="messages-container" id="messagesContainer">
                                    <div class="no-conversation">
                                        <i class="fas fa-comments fa-3x"></i>
                                        <p>Versi√≥n Windows - Funciona sin base de datos</p>
                                    </div>
                                </div>
                                <div class="message-input-container" id="messageInput" style="display: none;">
                                    <input type="text" id="chatInput" placeholder="Escribe tu mensaje...">
                                    <button class="btn-primary" onclick="sendMessage()">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    contentArea.innerHTML = `
                        <h1>üìã ${viewName.toUpperCase()}</h1>
                        <p>Funcionalidad disponible en versi√≥n Windows</p>
                        <div class="stat-card">
                            <h3>‚úÖ Sistema funcionando correctamente</h3>
                            <p>Sin errores de base de datos</p>
                        </div>
                    `;
            }
        }

        // Chat functions
        let currentChat = null;
        const chats = {
            1: {
                title: 'Prof. Luis ‚Üî Roberto (Padre)',
                messages: [
                    { sender: 'Roberto Rodriguez', content: 'Hola profesor, ¬øc√≥mo va mi hijo en matem√°ticas?', time: '10:30', isOwn: false },
                    { sender: 'T√∫', content: 'Hola Roberto, va muy bien. Ha mejorado mucho.', time: '10:32', isOwn: true }
                ]
            },
            2: {
                title: 'Grupo Padres-Profesores',
                messages: [
                    { sender: 'Prof. Luis', content: 'Reuni√≥n programada para ma√±ana a las 3 PM', time: '09:00', isOwn: false },
                    { sender: 'Roberto', content: 'Perfecto, ah√≠ estar√©', time: '09:05', isOwn: false }
                ]
            }
        };

        function openChat(chatId) {
            currentChat = chatId;
            const chat = chats[chatId];
            const header = document.querySelector('.chat-header');
            const container = document.getElementById('messagesContainer');
            const input = document.getElementById('messageInput');
            
            header.innerHTML = `<h3>${chat.title}</h3>`;
            
            container.innerHTML = chat.messages.map(msg => `
                <div class="message ${msg.isOwn ? 'own' : 'other'}">
                    <div class="message-content">
                        ${!msg.isOwn ? `<div class="message-sender">${msg.sender}</div>` : ''}
                        <div class="message-text">${msg.content}</div>
                        <div class="message-time">${msg.time}</div>
                    </div>
                </div>
            `).join('');
            
            input.style.display = 'flex';
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const content = input.value.trim();
            if (!content || !currentChat) return;
            
            const message = {
                sender: 'T√∫',
                content: content,
                time: new Date().toLocaleTimeString(),
                isOwn: true
            };
            
            chats[currentChat].messages.push(message);
            
            const container = document.getElementById('messagesContainer');
            const messageEl = document.createElement('div');
            messageEl.className = 'message own';
            messageEl.innerHTML = `
                <div class="message-content">
                    <div class="message-text">${content}</div>
                    <div class="message-time">${message.time}</div>
                </div>
            `;
            container.appendChild(messageEl);
            container.scrollTop = container.scrollHeight;
            
            input.value = '';
        }

        function showNewChatModal() {
            alert('Funcionalidad disponible - Crear nuevo chat');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                login(username, password);
            });

            document.getElementById('logoutBtn').addEventListener('click', function() {
                AppState.currentUser = null;
                AppState.isAuthenticated = false;
                document.getElementById('dashboardScreen').classList.remove('active');
                document.getElementById('loginScreen').classList.add('active');
            });

            // Modal close
            document.querySelector('.close').addEventListener('click', function() {
                document.getElementById('modal').style.display = 'none';
            });
        });

        console.log('‚úÖ LearnEx Windows Version cargada correctamente');
    </script>
</body>
</html>